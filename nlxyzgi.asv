% gaussian quadrature for triangle
% 13 points, order n=7
% l1 l2 l3 are barycentric coordinates
l1l2l3=[0.33333333333333298       0.47930806784191998       0.26034596607903998       ...
    0.26034596607903998       0.86973979419556802        6.5130102902216006E-002   ...
    6.5130102902216006E-002   4.8690315425316003E-002   4.8690315425316003E-002  ...
    0.31286549600487401       0.31286549600487401       0.63844418856981000      ...
    0.63844418856981000       ...
    0.33333333333333298       0.26034596607903998       0.47930806784191998       ...
    0.26034596607903998        6.5130102902216006E-002  0.86973979419556802       ...
    6.5130102902216006E-002  0.31286549600487401       0.63844418856981000      ...
    0.63844418856981000        4.8690315425316003E-002   4.8690315425316003E-002 ...
    0.31286549600487401       ...
    0.33333333333333398       0.26034596607904009       0.26034596607904009      ...
    0.47930806784192009        6.5130102902215978E-002   6.5130102902215992E-002 ...
    0.86973979419556802       0.63844418856981000       0.31286549600487401       ...
    4.8690315425315989E-002  0.63844418856981000       0.31286549600487401        ...
    4.8690315425315989E-002];
l1l2l3=reshape(l1l2l3,[13,3]);
l1=l1l2l3(:,1);
l2=l1l2l3(:,2);
l3=l1l2l3(:,3);
weights=[ -7.4785022233840995E-002   8.7807628716603997E-002   8.7807628716603997E-002   ...
    8.7807628716603997E-002   2.6673617804419000E-002   2.6673617804419000E-002  ...
    2.6673617804419000E-002   3.8556880445128498E-002   3.8556880445128498E-002  ...
    3.8556880445128498E-002   3.8556880445128498E-002   3.8556880445128498E-002  ...
    3.8556880445128498E-002]';

% eval nlx
nlx=nan(13,2,10);
for gi=1:13
    % d/dx
    nlx(gi,1,1) = subs(N_1x, [x y], [l1(gi) l2(gi)]);
    nlx(gi,1,1) = subs(N_1x, [x y], [l1(gi) l2(gi)]);
    nlx(gi,1,1) = subs(N_1x, [x y], [l1(gi) l2(gi)]);
    nlx(gi,1,1) = subs(N_1x, [x y], [l1(gi) l2(gi)]);
    nlx(gi,1,1) = subs(N_1x, [x y], [l1(gi) l2(gi)]);
    nlx(gi,1,1) = subs(N_1x, [x y], [l1(gi) l2(gi)]);
    nlx(gi,1,1) = subs(N_1x, [x y], [l1(gi) l2(gi)]);
    nlx(gi,1,1) = subs(N_1x, [x y], [l1(gi) l2(gi)]);
    nlx(gi,1,1) = subs(N_1x, [x y], [l1(gi) l2(gi)]);
    nlx(gi,1,1) = subs(N_1x, [x y], [l1(gi) l2(gi)]);
    % d/dy
    nlx(gi,2,1) = subs(N_1y, [x y], [l1(gi) l2(gi)]);
end